<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
    <PropertyGroup>
        <DotNetBuildOptions Condition=" '$(DotNetBuildOptions)' == '' ">$(DOTNET_BUILD_OPTIONS)</DotNetBuildOptions>
    </PropertyGroup>

    <Target Name="DotNetBuild">
        <ItemGroup>
            <BuildProjects Include="@(Projects)" />
        </ItemGroup>

        <Exec
            Command="dotnet build --version-suffix &quot;$(PreReleaseTag)&quot; --configuration &quot;$(Configuration)&quot; $(DotNetBuildOptions) @(BuildProjects->'&quot;%(FullPath)&quot;', ' ')"
            WorkingDirectory="$(RepositoryRoot)" />
    </Target>

    <PropertyGroup>
        <CompileDependsOn>
            DotNetBuild;
        </CompileDependsOn>
    </PropertyGroup>

    <Target Name="Compilation" DependsOnTargets="$(CompileDependsOn)" BeforeTargets="Compile" />
</Project>