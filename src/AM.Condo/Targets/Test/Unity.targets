<?xml version="1.0" encoding="utf-8"?>
<Project ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

  <PropertyGroup>
    <UnityTestOptions Condition=" $(UNITY_TEST_OPTIONS) != '' ">$(UNITY_TEST_OPTIONS)</UnityTestOptions>
  </PropertyGroup>

  <Target Name="UnityTest" Condition=" $(UnityTest) ">
    <Exec Command="xvfb-run --auto-servernum --server-args='-screen 0 640x480x24' &quot;$(UnityPath)&quot; -projectPath &quot;@(UnityProjectPath)&quot; -batchmode -testPlatform @(UnityTargets) -runTests -testResults &quot;$(TestArtifactsRoot)@(UnityTargets)$(slash)results.xml&quot; -logFile $(UnityTestOptions)"
        WorkingDirectory="@(UnityProjectPath)"
        IgnoreExitCode="true" />
  </Target>

  <PropertyGroup>
    <TestDependsOn>
      $(TestDependsOn);
      UnityTest;
    </TestDependsOn>
  </PropertyGroup>
</Project>
